{% extends "peer_review/baseAdmin.html" %}
{% load staticfiles %}

{% block extrahead %}
    <title>User Profile</title>
    <!--Edit navbar active-->
    <script>
        title = "";
    </script>
{% endblock extrahead %}

{% block context %}
    <div class="container">
        <h1>{{ userDetail.name }} {{ userDetail.surname }}</h1>

        <div class="panel-group" id="accordion">
            <div class="panel panel-default">
                <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" data-target="#collapseOne">
                    <h4 class="panel-title">
                        <a>
                            Box One <b class="caret"></b>
                        </a>
                    </h4>
                </div>

                <div id="collapseOne" class="panel-collapse collapse in">
                    <div class="panel-body">
                        <table class="table" id="userRoundsTable" data-pk="{{ user.pk }}" data-csrf="{{ csrf_token }}">
                            <thead>
                                <tr>
                                    <th>Round</th>
                                    <th>Team</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" data-target="#collapseTwo">
                    <h4 class="panel-title">
                        <a>
                            Box Two <b class="caret"></b>
                        </a>
                    </h4>
                </div>

                <div id="collapseTwo" class="panel-collapse collapse">
                    <div class="panel-body">

                    </div>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" data-target="#collapseThree">
                    <h4 class="panel-title">
                        <a>
                            Box Three <b class="caret"></b>
                        </a>
                    </h4>
                </div>

                <div id="collapseThree" class="panel-collapse collapse">
                    <div class="panel-body">

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
            $("#userRoundsTable").DataTable();

            var pk = $("#userRoundsTable").data("pk");
            var token = $("#userRoundsTable").data("csrf");

            var data = {
                "pk": pk,
                "csrfmiddlewaretoken": token
            };

            $.ajax({
                type: 'POST',
                url: '/maintainTeam/getTeams/',
                data: data,
                dataType: 'json',
                success: function(data) {
                    var table = $("#userRoundsTable").DataTable();
                    table.clear().draw();

                    $.each(data, function(index, value) {
                        console.log(value.status);
                        if(value.team != "emptyTeam") {
                            var row = table.row.add([
                                value.round,
                                value.team,
                                value.status
                            ]).draw(false).node();

                            $(row).attr("id", value.teamId);
                            $(row).find("." + value.status).attr("selected", "selected");
                        }
                    });
                }
            })
        });
    </script>
{% endblock context %}