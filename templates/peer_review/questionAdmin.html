{% extends "peer_review/baseAdmin.html" %}
{% load staticfiles %}

{% block extrahead %}
	<title>Question Admin</title>
{% endblock %}

{% block context %}
	<div class = "container">
		<div class = "panel panel-default">
			<div class="panel-heading">
				<h4 class="panel-title">Create Question</h4>
			</div>
			<div class="panel-body">
				<!-- Title -->
				<fieldset class="form-group">
					<label for="question-label">Title</label>
					<input type="text" class="form-control" id="question-label" placeholder="Enter title">
					<small class="text-muted">A short identifying name to be used in making questionnaires</small>
					</fieldset>
					<!-- Question Content -->
					<fieldset class="form-group">
					<label for="question-content">Question</label>
					<textarea class="form-control" id="question-content" name="question-content" rows="3" style="resize:none;width:100%">
					</textarea>
					</fieldset>
					<!-- Grouping/Type headings -->
					<div class="row">
						<div class="col-xs-6">
							<div class="pull-left">	  								
								<label>Question Grouping</label>
							</div>
						</div>
						<div class="col-xs-6">
							<div class="pull-right">	  								
								<label>Question Type</label>
							</div>
						</div>
					</div>
					<div class="row">
						<!-- Groupings -->
  					<div class="col-xs-6">
	  					<div class="btn-group pull-left" id = "groupings" data-toggle="buttons">
							<label class="btn btn-default active">
								<input type="radio" onchange="changeGrouping(this, 'rest')" autocomplete="off" checked> Rest
							</label>
							<label class="btn btn-default">
								<input type="radio" onchange="changeGrouping(this, 'none')" autocomplete="off"> None
							</label>
							<label class="btn btn-default">
								<input type="radio" onchange="changeGrouping(this, 'all')" autocomplete="off"> All
							</label>
							<label class="btn btn-default">
								<input type="radio" onchange="changeGrouping(this, 'label')" autocomplete="off"> Label
							</label>
						</div>
					</div>
					<!-- Types -->
  					<div class="col-xs-6">
  						<div class="btn-group pull-right" data-toggle="buttons">
							<label class="btn btn-default active">
								<input type="radio" autocomplete="off" onchange="changeType(this, 'choice')" checked>
								Choice
							</label>
							<label class="btn btn-default">
								<input type="radio" autocomplete="off" onchange="changeType(this, 'freeform')">
								Freeform
							</label>
							<label class="btn btn-default">
								<input type="radio" autocomplete="off" onchange="changeType(this, 'rank')">
								Rank
							</label>
							<label class="btn btn-default">
								<input type="radio" autocomplete="off" onchange="changeType(this, 'rate')">
								Rate
							</label>
							<label class="btn btn-default">
								<input type="radio" autocomplete="off" onchange="changeType(this, 'label')">
								Label
							</label>
						</div>
					</div>
					<input type="hidden" id="question-grouping">
					<input type="hidden" id="question-type">
				</div>
				<br/>
				<div id = "content">
				</div>
				<br/>
				<button type="button" class = "btn btn-primary">
					<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
					Submit
				</button>
				<button type="button" class = "btn btn-primary pull-right">
					<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
					Clear
				</button>
			</div>
		</div>
		<div class="panel-group" id="accordion">
                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" data-target="#collapseOne">
                        <h4 class="panel-title">
                            Maintain Questions <b class="caret"></b>
                        </h4>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse">
                        <div class="panel-body">
                            <input type="text" class="form-control" id="search" placeholder="Search">
                        </div>
                        <table id = "questionList" class="table">
                        	<tr>
                        		<td>h</td>
                        	</tr>
                        </table>                         
                    </div>
                </div>
        </div>
	</div>

	<!-- Label -->
	<div id = "label">
	</div>

	<!-- Choice -->
	<div id = "choice" class = "hidden">
		<div class = "row">
			<div class = "col-xs-6">
				<small>Click the <span class="glyphicon glyphicon-plus-sign text-primary"></span> icon to add choices.</small>
				<table class = "table table-bordered">
					<thead>
						<tr>
							<th class = "text-center">
								<span>Choices</span>
								<span style = "cursor: pointer" onclick = "addRowToTable(this)" class="glyphicon glyphicon-plus-sign pull-right text-primary"></span>
							</th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
			</div>
			<div class = "col-xs-6 labels-go-here">
			</div>
		</div>
	</div>

	<!-- Freeform -->
	<div id = "freeform" class = "hidden">
		<div class="row">
			<div class = "col-xs-4">
				<label for = "freeform-type">Freeform type</label>
					<select id="freeform-type" class = "form-control" onchange="changeFreeform(this)">
						<option value="integer">Integer</option>
						<option value="real">Real</option>
						<option value="paragraph">Paragraph</option>
						<option value="word">Word</option>
					</select>	
					<small>The type of answer the student is expected to give.</small>
			</div>
			<div class = "col-xs-2"></div>
			<div class = "col-xs-6 labels-go-here">
			</div>
		</div>
	</div>

	<!-- Rank -->
	<div id = "rank" class="hidden">
		<div class = "row">
			<div class = "col-xs-6">
				<input type="text" name="" class="form-control" placeholder="Enter top word">
			</div>
			<div class = "col-xs-6">
				<input type="text" name="" class="form-control" placeholder="Enter bottom word">
			</div>
		</div>
		<div class = "row">
			<br/>
			<div class = "col-xs-6 labels-go-here">
			</div>
		</div>
	</div>

	<!-- Rate -->
	<div id = "rate" class = "hidden">
		<div class = "row">
			<div class = "col-xs-6">
				<input type="text" name="" class="form-control" placeholder="Enter first value">
			</div>
			<div class = "col-xs-6">
				<input type="text" name="" class="form-control" placeholder="Enter second value">
			</div>			
		</div>
		<br>
		<div class = "row">
			<div class = "col-xs-6 labels-go-here">
			</div>
			<div class="col-xs-6">				
				<label>Optional: <input type="checkbox" name="rate-optional" value="Optional"></label>
			</div>
		</div>
	</div>

	<!-- Label table -->
	<div class = "hidden" id ="label-table">
		<small>Click the <span class="glyphicon glyphicon-plus-sign text-primary"></span> icon to add labels.</small>
		<table class = "table table-bordered">
			<thead>
				<tr>
					<th class = "text-center">
						<span>Labels</span>
						<span style = "cursor: pointer" onclick = "addRowToTable(this)" class="glyphicon glyphicon-plus-sign pull-right text-primary"></span>
					</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>


	<script>
		// Temporary
		$('#content').html($('#choice').html());
		$('.labels-go-here').hide();
		$('.labels-go-here').html($('#label-table').html());

		function changeType(el, type) {
			if ($(el).is(':checked')) {
				$('#content').html($('#'+type).html());
				$('#groupings').find('label').show(100);
				if (type == 'label') {
					$('#groupings').find('label').removeClass('active');
					$('#groupings').find('label').eq(1).addClass('active');
					$('#groupings').find('label').not(":eq(1)").hide(100);
				} else if (type == 'rank') {
					if ($('#groupings').find('label').eq(1).hasClass('active')) {
						$('#groupings').find('label').eq(0).addClass('active');
						$('#groupings').find('label').eq(1).removeClass('active');
					}
					$('#groupings').find('label').eq(1).hide(100);
				} else {
					// $('#groupings').find('label').removeClass('active');
				}
				$('#question-type').val(type);
			}
		}

		function changeGrouping(el, group) {
			if ($(el).is(':checked')) {
				if (group == 'label') {
					$('.labels-go-here').show(100);
				} else {
					$('.labels-go-here').hide(100);					
				}
				$('#question-grouping').val(group);
			}
		}

		//** Functions used for table manipulations **//
		function addRowToTable(el) {
			var row = $('<td></td>');
			row.append('<input type="text" placeholder="Enter choice" style="border:none;"/>');
			row.append('<span onclick="removeRow(this)" class = "glyphicon glyphicon-remove-circle pull-right text-primary" style="cursor:pointer"></span>');
			row.append('<span onclick="moveRow(this)" class = "glyphicon glyphicon-arrow-up pull-left text-primary" style="cursor:pointer"></span>');
			row.append('<span onclick="moveRow(this)" class = "glyphicon glyphicon-arrow-down pull-left text-primary" style="cursor:pointer"></span>');

			
			$(el).closest('table').find('tbody').append(row);
			row.wrap('<tr></tr>');
			row.addClass('text-center');
		}

		function removeRow(el) {
			$(el).closest('tr').remove();
		}

		function moveRow(el) {
			var row = $(el).closest('tr');
	        if ($(el).hasClass('glyphicon-arrow-up'))
	            row.prev().before(row);
	        else if ($(el).hasClass('glyphicon-arrow-down'))
	            row.next().after(row);
		}


	</script>
{% endblock %}