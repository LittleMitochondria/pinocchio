<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Pinocchio</title>
        <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0" />
        {% load staticfiles %}
        <script type="text/javascript" src="{% static "peer_review/js/jquery.min.js" %}"></script>
        <script type="text/javascript" src="{% static "peer_review/js/bootstrap.min.js" %}"></script>
        <link rel="stylesheet" type="text/css" href="{% static "peer_review/css/bootstrap.min.css" %}">
        <script type="text/javascript" src="{% static "peer_review/js/bootstrap-table.min.js" %}"></script>
        <link rel="stylesheet" type="text/css" href="{% static "peer_review/css/bootstrap-table.min.css" %}">
        <link rel="stylesheet" href="{% static "peer_review/css/style.css" %}" />
        <script type="text/javascript" src="{% static "peer_review/js/stacking.js" %}" ></script>
        <script type="text/javascript">
            function addOnSubmitHandler() {
                $('#questionForm').on('submit', function(event){
                    event.preventDefault();
                    console.log("form submitted!")  // sanity check
                    create_post();
                });
            }
            
            function selected()
            {
                var value = document.getElementById("type").value;
                document.getElementById("typeDisplay").innerHTML = document.getElementById(value).innerHTML;
                choices = getChoices();
                console.log(choices);
                initialiseStacking();
            }
            
            function getAllRows()
            {
                var myObjects = [];
            
                $('#typeDisplay table tbody tr').each(function (index, value)
                {
                    var row = getRow(index);
                    myObjects.push(row);
                });
            
                return myObjects;
            }
            
            function getChoices()
            {
                var choices = [];
            
                $('#typeDisplay table tbody tr').each(function (index, value)
                {
                    var choice = $('#typeDisplay table tbody tr').eq(index).find('td:eq(0)').find('*').val();
                    if (choice != '')
                        choices.push(choice);
                });
            
                return choices;
            }
            
            // Read the row into an object
            function getRow(rowNum)
            {
                var row = $('#typeDisplay table tbody tr').eq(rowNum);
            
                var myObject = {};
            
                myObject.ChangeType = row.find('td:eq(0)').text();
                myObject.UpdateType = row.find('td:eq(1)').text();
                myObject.three = row.find('td:eq(2)').text();
            
                return myObject;
            }
            
            function addChoice()
            {
                $('#table').append(
                                   '<tr>' +
                                       '<td style="text-align: center; ">' +
                                        '<input type="text" class="noBorder" id="choice" value="-" style="text-align: center; "/>' +
                                       '</td>' +
                                       '<td style="text-align: center; width: 20px;">' +
                                           '<a class="move up" href="javascript:void(0)" title="move up">' +
                                               '<span class="glyphicon glyphicon-arrow-up"></span>' +
                                           '</a>' +
                                       '</td>' +
                                       '<td style="text-align: center; width: 20px; ">' +
                                       '<a class="move down" href="javascript:void(0)" title="move down">' +
                                           '<span class="glyphicon glyphicon-arrow-down"></span>' +
                                       '</a>' +
                                       '</td>' +
                                   '</tr>'
                                   );                              
            }
            
            // AJAX for posting
            function create_post() {
                console.log("create post is working!") // sanity check

                if ($('#question').val() == '')
                {
                    var r = confirm("No question entered. Save anyways?");
                    if (!r)
                        return;
                };

                var data = {
                            question : $('#question').val(),
                            questionType : $('#type').val(),
                            };

                switch ($('#type').val()) 
                {
                    case 'Choice':
                        data.choices = getChoices()
                        data.grouping = $('#grouping').val();
                        break;
                    case 'Rank':
                        data.firstWord = $('#first').val();
                        data.secondWord = $('#second').val();
                        data.grouping = $('#grouping').val();
                        break;
                    case 'Label': break;
                    case 'Rate': break;
                    case 'Freeform' : break;
                }; //End switch


                console.log(data); //Check
                $.ajax({
                    url : "/peer/createQuestion/", // the endpoint
                    type : "GET", // http method
                    data : data, // data sent with the post request
            
                    // handle a successful response
                    success : function(json) {
                        //$('#post-text').val(''); // remove the value from the input
                        console.log(json); // log the returned json to the console
                        console.log("success"); // another sanity check
                    },
            
                    // handle a non-successful response
                    error : function(xhr,errmsg,err) {
                        alert("Error!");
                        // $('#results').html("<div class='alert-box alert radius' data-alert>Oops! We have encountered an error: "+errmsg+
                        //     " <a href='#' class='close'>&times;</a></div>"); // add the error to the dom
                        // console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
                    }
                });
            };
        </script>
    </head>
    
    <body onload="selected(); addOnSubmitHandler();">
        <nav class="navbar navbar-inverse navbar-static-top">
            <div class="container">
                <div class="navbar-header">
                    <a href="index.html" class="navbar-brand">Pinocchio</a>
                    <button class="navbar-toggle" data-toggle="collapse" data-target=".navHeaderCollapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse navHeaderCollapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="userAdmin.html">User Admin</a>
                        </li>
                        <li>
                            <a href="maintainRound.html">Maintain Rounds</a>
                        </li>
                        <li>
                            <a href="teamBuilder.html">Team Builder</a>
                        </li>
                        <li>
                            <a href="maintainTeam.html">Maintain Teams</a>
                        </li>
                        <li class="active">
                            <a href="questionAdmin.html">Create Question</a>
                        </li>
                        <li>
                            <a href="questionnaireAdmin.html">Questionnaire Admin</a>
                        </li>
                        <li>
                            <a href="result.html">Results</a>
                        </li>
                        <li>
                            <a href="fileManager.html">File Manager</a>
                        </li>
                        <li>
                            <a href="serverManager.html">Server Manager</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="navbar navbar-default navbar-fixed-bottom">
            <div class="container">
                <p class="navbar-text pull-left">&copy; Dillon Heins</p>
                <a class="navbar-btn btn-danger btn pull-right">Log Out</a>
            </div>
        </div>
        <div class="container" id="content">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <b>Create Question</b>
                    </h4>
                </div>
                <div class="panel-body">
                    <form role="form" id="questionForm" action="/peer/createQuestion/" method="GET">
                    {% csrf_token %}
                    <input type="hidden" id="tableData">
                        <div class="form-group">
                            <label for="question">Question</label>
                            <textarea class="form-control" cols="40" rows="3" style="resize:none;width:auto" id="question" name="question"></textarea>
                            <br />
                            <label>Type</label>
                            <select id="type" class="form-control" style="width:auto" onchange="selected()" name="type">
                                {% if questionTypes %}
                                {% for qt in questionTypes %}
                                <option value="{{qt.name}}">{{ qt.name }}</option>
                                {% endfor %}
                                {% endif %}
                            </select>
                            <br />
                            <div id="typeDisplay">
                                <div class="row">
                                    <div class="col-xs-4"></div>
                                    <div class="col-xs-1">
                                        <button class="btn btn-primary" id="add">+ Add</button>
                                    </div>
                                    <div class="col-xs-7">
                                        <b>Grouping</b>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="panel panel-default">
                                            <div class="panel-body">
                                                <table id="table" class="table"></table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-5">
                                        <select class="form-control" id="grouping">
                                            <option value="Rest">Rest</option>
                                            <option value="All">All</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <br />
                                <button class="btn btn-primary" type="submit">Save</button>
                            </div>
                        </div>
                        <form>
                </div>
            </div>
        </div>
        <div id="hidden" class="hidden">
            <div id="Label"></div>
            <div id="Choice">
                <div class="row">
                    <div class="col-xs-4"></div>
                    <div class="col-xs-1">
                        <button class="btn btn-primary" id="btn" type = "button" onclick = "addChoice()">+ Add</button>
                    </div>
                    <div class="col-xs-7">
                        <b>Grouping</b>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-5">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <table id="table" class="table table-striped table-condensed table-hover btable">
                                    <thead>
                                        <tr>
                                            <th style="text-align: center; ">
                                                <div class="th-inner ">Choices</div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; width: 20px; ">
                                                <div class="th-inner "></div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; width: 20px; ">
                                                <div class="th-inner "></div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr data-index="0">
                                            <td style="text-align: center; ">
                                                <input type="text" class="noBorder" id="choice" value="Chicken" style="text-align: center; "/>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="1">
                                            <td style="text-align: center; ">
                                                <input type="text" class="noBorder" id="choice" value="Beef" style="text-align: center; "/>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="2">
                                            <td style="text-align: center; ">
                                                <input type="text" class="noBorder" id="choice" value="Fish" style="text-align: center; "/>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="3">
                                            <td style="text-align: center; ">
                                                <input type="text" class="noBorder" id="choice" value="Other" style="text-align: center; "/>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-5">
                        <select class="form-control" id="grouping">
                            <option value="None">None</option>
                            <option value="Rest">Rest</option>
                            <option value="All">All</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="Rate">
                <div class="row">
                    <div class="col-xs-4"></div>
                    <div class="col-xs-1">
                        <button class="btn btn-primary" id="btn">+ Add</button>
                    </div>
                    <div class="col-xs-7">
                        <b>Grouping</b>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-5">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <table id="table" class="table table-striped table-condensed table-hover btable">
                                    <thead>
                                        <tr>
                                            <th style="text-align: center; ">
                                                <div class="th-inner ">Scale</div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; ">
                                                <div class="th-inner ">Optional</div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; ">
                                                <div class="th-inner ">Choice</div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; width: 20px; ">
                                                <div class="th-inner "></div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; width: 20px; ">
                                                <div class="th-inner "></div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr data-index="0">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Chicken</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="1">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Beef</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="2">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Fish</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="3">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Other</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-5">
                        <select class="form-control" id="grouping">
                            <option value="Rest">Rest</option>
                            <option value="All">All</option>
                        </select>
                    </div>
                </div>
            </div>
            <div id="Rank">
                <table>
                    <div class="row">
                        <div class="col-xs-4">
                            <label for='first'>First Word</label>
                        </div>
                        <div class="col-xs-4">
                            <label for='second'>Second Word</label>
                        </div>
                        <div class="col-xs-4">
                            <label for='grouping'>Grouping</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-4">
                            <input class='form-control' type='text' id='first' />
                        </div>
                        <div class="col-xs-4">
                            <input class='form-control' type='text' id='second' />
                        </div>
                        <div class="col-xs-4">
                            <select class='form-control' id='grouping'>
                                <option value='Rest'>Rest</option>
                                <option value='All'>All</option>
                            </select>
                        </div>
                    </div>
                </table>
            </div>
            <div id="Freeform">
                <div class="row">
                    <div class="col-xs-4"></div>
                    <div class="col-xs-1">
                        <button class="btn btn-primary" id="btn">+ Add</button>
                    </div>
                    <div class="col-xs-7">
                        <b>Grouping</b>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-5">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <table id="table" class="table table-striped table-condensed table-hover btable">
                                    <thead>
                                        <tr>
                                            <th style="text-align: center; ">
                                                <div class="th-inner ">Type</div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; ">
                                                <div class="th-inner ">Choice</div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; width: 20px; ">
                                                <div class="th-inner "></div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                            <th style="text-align: center; width: 20px; ">
                                                <div class="th-inner "></div>
                                                <div class="fht-cell"></div>
                                                <div style="margin: 0px 2px 2px; display: none;" class="filterControl">
                                                    <div style="height: 34px;"></div>
                                                </div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr data-index="0">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Chicken</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="1">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Beef</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="2">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Fish</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                        <tr data-index="3">
                                            <td style="text-align: center; width: 10px;">
                                                <div class="checkbox">
                                                    <input type="checkbox">
                                                </div>
                                            </td>
                                            <td style="text-align: center; ">Other</td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move up" href="javascript:void(0)" title="move up"><span
                class="glyphicon glyphicon-arrow-up"></span></a>
                                            </td>
                                            <td style="text-align: center; width: 20px; ">
                                                <a class="move down" href="javascript:void(0)" title="move down"><span
                class="glyphicon glyphicon-arrow-down"></span></a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-5">
                        <select class="form-control" id="grouping">
                            <option value="None">None</option>
                            <option value="Rest">Rest</option>
                            <option value="All">All</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        </div>
        </div>
    </body>

</html>